### Introduction
This repository contains the necessary code to implement the Mot problem using yolov5 and the deepsort algorithm for tracking, also in this first version we have an approach to try to differentiate 2 different actions of walking and running, for this first approach to recognize anomalies we use the predictions which are obtained from yolov5 and different classifiers such as KNN, SVM, GP, DT, MLP and NB.
For this process we just need all the original python executable files and videos found in the link provided more below,however in this repository are all the executable files and all the files gererated by the scripts,so you only need to run the clasificador.py and graficar.py to see the most important results.
![](https://www.bdd100k.com/images/portfolio/det.png)

**Table of content **


[TOC]

##Instructions (Prepate environment)

                
1. Download the repository
`git clone https://github.com/JuanNoraB/MOT_anomalies.git`

2. Create a conda environment 
`conda create --name YOLOv5`

3. Activate enviroment
`conda activate YOLOv5`

4. Install requeriment.txt
`pip install -r requirements.txt`

5. In the current directory we use 10 diferrents videos of 2 classses, 5 in wich ara a person walking and the others 5 with the same person running, If you want to run from the begining please download the vidoes from the next link: https://drive.google.com/drive/folders/1GR7oigqWWa2Rotx_uIZyULTV_v3K3WJe?usp=sharing
                

##Run  yolov5demo.py
If you have to obtain for your own all the .csv files that contain the (x,y),weight,height,category,id columns and the videos all the videos with all the respect tracking run for each video:
```bash
python 3 yolov5demo.py "path of your video"
```
the output will be a video with the tracking and a name_video.csv file with all the prediction proportionate by yolov5

##diferencial.py
If you want to obtain the all the .csv with the relationship with respect x,y, the relectionship with the area, and the target run the diferencial.py you will obtain the F_name_video.csv file for each csv file obtain of the process previus.

##Classifier
In the clasificadores.py there are 6 differents clasifiers that we can probe, but first it is nesessary run the data_set.py script this script generate differents test and traininf file,then first 
                

1. `python3 data_set.py`
2. For the clasificadores.py It's necessary change the line `model_name = ' model' ` with the model that we want to use and the lines 
`train = pandas.read_csv('train_0.csv')`
 `test = pandas.read_csv('test_0.csv')`
with the one generated by the data_set.py script, we can visualize a graph that shows how the accuracy of the model.


				

##Analysis of the aproach
this approach yielded poor results was not able to classify the 2 different behaviors based on yolo5's predictions, so the graficar.py allows analyze in a visual way the reasons of this happen.
to see en a better way the results use jupiter, colab or install jupiter in visual studio code, then execute this script in blocks.
